# Roadmap: stash-mgr

## Overview

Build a Rust TUI tool for managing git stashes across four phases: establish the TUI foundation and git integration (Phase 1), implement read-only stash browsing with diff previews (Phase 2), add working directory scanning and file-level stash creation (Phase 3), and polish the end-to-end experience with robust error handling and cross-platform testing (Phase 4). The roadmap delivers the core value — selective file-level stashing with a clear visual interface — while deferring hunk-level selection to v2.

## Phases

**Phase Numbering:**
- Integer phases (1, 2, 3): Planned milestone work
- Decimal phases (2.1, 2.2): Urgent insertions (marked with INSERTED)

Decimal phases appear between their surrounding integers in numeric order.

- [x] **Phase 1: Foundation** - TUI scaffold with git integration and tab navigation
- [x] **Phase 2: Stash Browser** - Read-only stash operations with diff preview
- [x] **Phase 3: Stash Creator** - Working directory scanning and file-level stashing
- [x] **Phase 4: Integration & Polish** - End-to-end testing and error hardening

## Phase Details

### Phase 1: Foundation
**Goal**: User can launch the application, see a working TUI with two tabs, and navigate between them
**Depends on**: Nothing (first phase)
**Requirements**: FNDN-01, FNDN-02, FNDN-03, FNDN-04
**Success Criteria** (what must be TRUE):
  1. User can run the binary from any git repository and the app detects the repo
  2. User can switch between Create Stash and Manage Stashes tabs using Tab key
  3. User can quit the application with 'q' key and terminal state is restored
  4. Terminal panics restore terminal state (alternate screen exited, raw mode disabled)
**Plans:** 1 plan

Plans:
- [x] 01-01-PLAN.md — Project scaffold with terminal lifecycle, git detection, and tab navigation UI

### Phase 2: Stash Browser
**Goal**: User can browse existing stashes, preview their contents, and apply or delete them
**Depends on**: Phase 1
**Requirements**: BRWS-01, BRWS-02, BRWS-03, BRWS-04, BRWS-05, BRWS-06
**Success Criteria** (what must be TRUE):
  1. User can see a list of all stashes with index, message, and branch name in the Manage Stashes tab
  2. User can navigate the stash list with arrow keys and see diff preview update
  3. User can apply a stash (keep in list) with a keyboard shortcut
  4. User can pop a stash (apply and remove) with a keyboard shortcut
  5. User can drop a stash with confirmation prompt to prevent accidental deletion
**Plans:** 2 plans

Plans:
- [x] 02-01-PLAN.md — Stash list display with navigation and diff preview panel
- [x] 02-02-PLAN.md — Stash operations: apply, pop, and drop with confirmation

### Phase 3: Stash Creator
**Goal**: User can see working directory changes and selectively stash chosen files
**Depends on**: Phase 2
**Requirements**: CREA-01, CREA-02, CREA-03, CREA-04, CREA-05, CREA-06
**Success Criteria** (what must be TRUE):
  1. User can see modified and staged tracked files (no untracked) in the Create Stash tab
  2. User can navigate the file list with arrow keys
  3. User can toggle file selection with checkboxes using space key
  4. User is prompted for a stash message before creating a stash
  5. User can create a stash from selected files and see the file list refresh
**Plans:** 2 plans

Plans:
- [x] 03-01-PLAN.md — File list display with navigation and checkbox selection
- [x] 03-02-PLAN.md — Stash message prompt and selective file stashing

### Phase 4: Integration & Polish
**Goal**: Application handles edge cases gracefully and works reliably across platforms
**Depends on**: Phase 3
**Requirements**: (Integration of all prior phases)
**Success Criteria** (what must be TRUE):
  1. User sees helpful error messages (not panics) for common failures (no git repo, detached HEAD, locked index)
  2. Application works on macOS, Linux, and Windows without platform-specific bugs
  3. User can complete full workflow (create stash with selected files, switch tabs, browse stashes, apply/pop/drop) without errors
  4. Large diffs and repositories don't cause memory issues or UI freezes
**Plans:** 2 plans

Plans:
- [x] 04-01-PLAN.md — User-friendly error handling and repository validation
- [x] 04-02-PLAN.md — Large diff performance safeguards and end-to-end verification

## Progress

**Execution Order:**
Phases execute in numeric order: 1 → 2 → 3 → 4

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 1. Foundation | 1/1 | ✓ Complete | 2026-02-11 |
| 2. Stash Browser | 2/2 | ✓ Complete | 2026-02-11 |
| 3. Stash Creator | 2/2 | ✓ Complete | 2026-02-12 |
| 4. Integration & Polish | 2/2 | ✓ Complete | 2026-02-12 |
